
<div class="container">


<h1 class="text-center mt-5">Thank you for trusting our services!</h1>
<h2 class="text-center mb-5">Here is a recap of all the courgettes you have booked!</h2>

<% if notice %>

<div class="flash flash-success alert alert-dismissible fade show" role="alert">



  <span class="flex-grow-1"><%= notice %></span>


   <a data-dismiss="alert" aria-label="Close">
    <i class="fas fa-times"></i>
  </a>

 </div>


<% end %>



<div class="d-flex">

  <div class="bookings-list card flex-grow-1 mr-3 p-3 d-flex flex-column align-items-center justify-content-center">

    <% if @bookings.empty? %>



    <h4 class="mb-4">ðŸ¥’ It seems that you haven't booked any courgette yet ðŸ¥’</h4>
    <%= link_to "Browse and book!", courgettes_path, class: "btn btn-success"%>







    <% end %>



  </div>


  <div class="card current-user-card p-4 text-center d-flex align-items-center flex-column">

    <h3>My details</h3>

    <%= cl_image_tag current_user.photo.key, class: "card-user-avatar my-4" %>

    <h4><%= "#{current_user.first_name} #{current_user.last_name}"  %></h4>
    <p>(<strong><%= current_user.username %></strong>)</p>

    <%= link_to "Edit your profile", edit_user_registration_path %>






  </div>















</div>

<!-- LIMITE DE LA NOUVELLE ET DE LA VIEILLE VERSION -->
<!-- LIMITE DE LA NOUVELLE ET DE LA VIEILLE VERSION -->
<!-- LIMITE DE LA NOUVELLE ET DE LA VIEILLE VERSION -->
<!-- LIMITE DE LA NOUVELLE ET DE LA VIEILLE VERSION -->
<!-- LIMITE DE LA NOUVELLE ET DE LA VIEILLE VERSION -->
<!-- LIMITE DE LA NOUVELLE ET DE LA VIEILLE VERSION -->
<!-- LIMITE DE LA NOUVELLE ET DE LA VIEILLE VERSION -->
<!-- LIMITE DE LA NOUVELLE ET DE LA VIEILLE VERSION -->
<!-- LIMITE DE LA NOUVELLE ET DE LA VIEILLE VERSION -->


<% unless params[:format].nil? %>


<div class="card">
  <h2>This is your last booking:</h2>
  <% last_booking = Booking.find(params[:format]) %>
  <p><%= last_booking.created_at %></p>
</div>

<% end %>



<% @bookings.each do |booking| %>

<div class="card-product my-4">
<% courgette = Courgette.find(booking.courgette_id) %>
<%= cl_image_tag courgette.photo.key, crop: :fill, class: "ml-2" %>


<div class="ml-5">

  <p></p>
  <h2><%= courgette.name %> </h2>
  <p><% ( days= Date.parse(booking.end_date.to_s) - Date.parse(booking.start_date.to_s)) %></p>
  <p> <%= days.to_i %> <%= days.to_i == 1 ? "day" : "days" %></p>
  <p>From <%= booking.start_date.strftime("%d %B %Y") %> to <%= booking.end_date.strftime("%d %B %Y")%> (<%= courgette.price %>  â‚¬ per day)</p>
  <p>You own <%= days.to_i * courgette.price %>â‚¬ to <%= "#{courgette.user.first_name} #{courgette.user.last_name}" %></p>

  <%= link_to "Cancel this booking", booking_path(booking), method: :delete, data: {confirm: "Are you sure?"}, class: "mb-2" %>

</div>

</div>

<% end %>



<%= link_to "Book some more, always more!", courgettes_path, class: "btn btn-success btn-block my-5 mx-3" %>

</div>


